 
# Documentation

## Scanning for the target machine ip
`Note the target machine is a vulnerable machine for testing and educational purposes!`
### Checking the subnet the machine is on
```bash
┌──(lamood㉿kali)-[~]
└─$ ifconfig                   
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.64.129  netmask 255.255.255.0  broadcast 192.168.64.255
        ether 00:0c:29:19:0f:41  txqueuelen 1000  (Ethernet)
        RX packets 20618  bytes 21468844 (20.4 MiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 12726  bytes 1341204 (1.2 MiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 2145  bytes 187810 (183.4 KiB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 2145  bytes 187810 (183.4 KiB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```

### Ping scanning the network to find the target machine
```bash
┌──(lamood㉿kali)-[~]
└─$ nmap -sn 192.168.64.0/24   
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-01 07:09 EDT
Nmap scan report for 192.168.64.2
Host is up (0.00059s latency).
Nmap scan report for 192.168.64.129
Host is up (0.0030s latency).
Nmap scan report for 192.168.64.130
Host is up (0.00045s latency).
Nmap done: 256 IP addresses (3 hosts up) scanned in 2.48 seconds

```

From the command output there was two devices other than the router
`192.168.64.129` which is my device
`192.168.64.130` the target machine

---
## Scanning the target for open ports using nmap

### Scanning most common ports
```bash
┌──(lamood㉿kali)-[~]
└─$ nmap --top-ports 10 192.168.64.130 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-01 07:20 EDT
Nmap scan report for 192.168.64.130
Host is up (0.00098s latency).

PORT     STATE  SERVICE
21/tcp   open   ftp
22/tcp   open   ssh
23/tcp   open   telnet
25/tcp   open   smtp
80/tcp   open   http
110/tcp  closed pop3
139/tcp  open   netbios-ssn
443/tcp  closed https
445/tcp  open   microsoft-ds
3389/tcp closed ms-wbt-server

```

After the scan is complete, we can see multiple open ports that could be vulnerable which should be noted to be further scanned

### Re scanning the target with the vuln script category

This will run all vulnerability detection scripts against the target.
```bash
┌──(root㉿kali)-[/home/lamood]
└─# nmap --script vuln 192.168.64.130
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-09-1 07:25 EDT
Nmap scan report for 192.168.64.130
Host is up (0.0017s latency).
Not shown: 979 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|       https://www.securityfocus.com/bid/48539
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
|_sslv2-drown: ERROR: Script execution failed (use -d to debug)
| ssl-dh-params: 
|   VULNERABLE:
|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use anonymous
|       Diffie-Hellman key exchange only provide protection against passive
|       eavesdropping, and are vulnerable to active man-in-the-middle attacks
|       which could completely compromise the confidentiality and integrity
|       of any data exchanged over the resulting session.
|     Check results:
|       ANONYMOUS DH GROUP 1
|             Cipher Suite: TLS_DH_anon_WITH_AES_128_CBC_SHA
|             ...

```

This machine is a vulnerable machine in almost every way as it is for testing and education so the scan returned a lot of findings, using these findings we would normally document them all one by one with details but due to the sheer amount of vulnerabilities in this machine I will only be documenting a few with their recommended actions.

## Findings and Mitigation strategies

# Vulnerability Findings and Mitigation Strategies

### 1. vsFTPd Backdoor (CVE-2011-2523)

**Finding:** The FTP server is running vsFTPd version 2.3.4, which contains a known backdoor vulnerability.

**Mitigation:** 
- Immediately upgrade vsFTPd to the latest stable version.
- If possible, consider using an alternative FTP server software.
- Implement strict access controls and monitor FTP traffic for suspicious activity.

### 2. Anonymous Diffie-Hellman Key Exchange Vulnerability

**Finding:** The server allows anonymous Diffie-Hellman key exchange, which is vulnerable to man-in-the-middle attacks.

**Mitigation:**
- Disable anonymous Diffie-Hellman cipher suites.
- Configure the server to use only strong, authenticated key exchange methods.
- Implement perfect forward secrecy (PFS) using ephemeral Diffie-Hellman (DHE) or Elliptic Curve Diffie-Hellman (ECDHE).

### 3. SSL POODLE Vulnerability (CVE-2014-3566)

**Finding:** The server supports SSL 3.0, which is vulnerable to the POODLE attack.

**Mitigation:**
- Disable SSL 3.0 support on all services.
- Enable TLS 1.2 or higher as the preferred protocol.
- Implement TLS_FALLBACK_SCSV to prevent protocol downgrade attacks.

### 4. Diffie-Hellman Key Exchange Insufficient Group Strength

**Finding:** The server uses Diffie-Hellman groups with insufficient strength (1024-bit), which may be susceptible to passive eavesdropping attacks.

**Mitigation:**
- Increase the Diffie-Hellman group size to at least 2048 bits.
- Consider using elliptic curve cryptography (ECC) for key exchange.
- Regularly update and rotate cryptographic parameters.

### 5. RMI Registry Default Configuration Vulnerability

**Finding:** The RMI registry has a default configuration that allows loading classes from remote URLs, potentially leading to remote code execution.

**Mitigation:**
- Reconfigure the RMI registry to disable loading classes from remote URLs.
- Implement strict access controls for the RMI registry.
- Use firewalls to restrict access to the RMI registry port (default 1099).
- Consider using alternative, more secure remote method invocation mechanisms if possible.


---
# **References**

